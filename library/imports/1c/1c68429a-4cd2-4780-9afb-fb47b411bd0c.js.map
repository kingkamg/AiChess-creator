{"version":3,"sources":["../../../../assets/scripts/assets/scripts/GameBoard.js"],"names":["Constant","require","Stone","cc","Class","extends","Component","properties","piecesAtlas","default","type","SpriteAtlas","piecePrefab","Prefab","onLoad","node","on","Node","EventType","TOUCH_START","e","pos","convertToNodeSpaceAR","getLocation","row","Math","floor","y","left_bottom_pos","len_y","cell_size","col","x","len_x","bind","init32Stones","game_board_init_info","k","stone_info","turn_type","stone_type","createPieceByName","stone_res_config","stone","m_piecePrefab","setPosition","addChild","put_piece_at","piece","red","che","pieceName","instantiate","getComponent","Sprite","spriteFrame","getSpriteFrame"],"mappings":";;;;;;AAAA;;;;AAIA,IAAIA,WAAWC,QAAQ,eAAR,CAAf;AACA,IAAIC,QAAQD,QAAQ,YAAR,CAAZ;;AAEA;AACAE,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;;AAER;AACAC,qBAAa;AACTC,qBAAS,IADA;AAETC,kBAAMP,GAAGQ;AAFA,SAHL;;AAQR;AACAC,qBAAY;AACRH,qBAAS,IADD;AAERC,kBAAMP,GAAGU;AAFD;AATJ,KAHP;;AAkBL;AACAC,UAnBK,oBAmBK;;AAEN,aAAKC,IAAL,CAAUC,EAAV,CAAab,GAAGc,IAAH,CAAQC,SAAR,CAAkBC,WAA/B,EAA4C,UAASC,CAAT,EAAW;;AAEnD,gBAAIC,MAAM,KAAKN,IAAL,CAAUO,oBAAV,CAA+BF,EAAEG,WAAF,EAA/B,CAAV;;AAEA,gBAAIC,MAAMC,KAAKC,KAAL,CAAY,CAACL,IAAIM,CAAJ,GAAQ3B,SAAS4B,eAAT,CAAyBC,KAAjC,GAAyC7B,SAAS8B,SAAT,GAAmB,GAA7D,IAAoE9B,SAAS8B,SAAzF,CAAV;AACA,gBAAIC,MAAMN,KAAKC,KAAL,CAAY,CAACL,IAAIW,CAAJ,GAAQhC,SAAS4B,eAAT,CAAyBK,KAAjC,GAAyCjC,SAAS8B,SAAT,GAAmB,GAA7D,IAAoE9B,SAAS8B,SAAzF,CAAV;;AAEA;AACA,gBAAGN,MAAM,CAAN,IAAWA,MAAM,CAAjB,IAAsBO,MAAM,CAA5B,IAAiCA,MAAM,CAA1C,EAA4C;AACxC;AACH,aAFD,MAEK;AACD;AACH;AAEJ,SAd2C,CAc1CG,IAd0C,CAcrC,IAdqC,CAA5C,EAcc,IAdd;;AAgBA;AACA,aAAKC,YAAL;AAGH,KAzCI;;;AA2CLA,kBAAc,wBAAU;;AAEpB;AACA,YAAIC,uBAAuBpC,SAASoC,oBAApC;;AAEA,aAAI,IAAIC,CAAR,IAAaD,oBAAb,EAAkC;AAC9B,gBAAIE,aAAaF,qBAAqBC,CAArB,CAAjB;;AAEA,gBAAIb,MAAMc,WAAWd,GAArB;AACA,gBAAIO,MAAMO,WAAWP,GAArB;AACA,gBAAIQ,YAAYD,WAAWC,SAA3B;AACA,gBAAIC,aAAaF,WAAWE,UAA5B;AACA,gBAAI5B,cAAc,KAAK6B,iBAAL,CAAuBzC,SAAS0C,gBAAT,CAA0BH,SAA1B,EAAqCC,UAArC,CAAvB,CAAlB;;AAEA;AACA,gBAAIG,QAAQ,IAAIzC,KAAJ,CAAUqC,SAAV,EAAqBC,UAArB,EAAiC,KAAjC,EAAwChB,GAAxC,EAA6CO,GAA7C,EAAkDnB,WAAlD,CAAZ;;AAEA,gBAAIoB,IAAKD,MAAM/B,SAAS8B,SAAf,GAA2B9B,SAAS4B,eAAT,CAAyBK,KAA7D;AACA,gBAAIN,IAAKH,MAAMxB,SAAS8B,SAAf,GAA2B9B,SAAS4B,eAAT,CAAyBC,KAA7D;AACAc,kBAAMC,aAAN,CAAoBC,WAApB,CAAgCb,CAAhC,EAAmCL,CAAnC;AACA,iBAAKZ,IAAL,CAAU+B,QAAV,CAAmBH,MAAMC,aAAzB;AACA;AAEH;AACJ,KAnEI;;AAqEL;AACAG,kBAAc,sBAASvB,GAAT,EAAcO,GAAd,EAAmB;;AAE7B,YAAIC,IAAKD,MAAM/B,SAAS8B,SAAf,GAA2B9B,SAAS4B,eAAT,CAAyBK,KAA7D;AACA,YAAIN,IAAKH,MAAMxB,SAAS8B,SAAf,GAA2B9B,SAAS4B,eAAT,CAAyBC,KAA7D;;AAEA;AACA;AACA,YAAImB,QAAQ,KAAKP,iBAAL,CAAuBzC,SAAS0C,gBAAT,CAA0B1C,SAASuC,SAAT,CAAmBU,GAA7C,EAAkDjD,SAASwC,UAAT,CAAoBU,GAAtE,CAAvB,CAAZ;AACAF,cAAMH,WAAN,CAAkBb,CAAlB,EAAqBL,CAArB;AACA,aAAKZ,IAAL,CAAU+B,QAAV,CAAmBE,KAAnB;AACH,KAhFI;;AAkFL;AACAP,uBAAmB,2BAASU,SAAT,EAAmB;AAClC,YAAIH,QAAQ7C,GAAGiD,WAAH,CAAe,KAAKxC,WAApB,CAAZ;AACAoC,cAAMK,YAAN,CAAmBlD,GAAGmD,MAAtB,EAA8BC,WAA9B,GAA4C,KAAK/C,WAAL,CAAiBgD,cAAjB,CAAgCL,SAAhC,CAA5C;AACA,eAAOH,KAAP;AACH;AAvFI,CAAT","file":"GameBoard.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["/**\n * 功能：游戏棋盘相关逻辑\n */\n\nvar Constant = require('./Constant.js');\nvar Stone = require('./Stone.js');\n\n//\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        \n        //图集资源，用于初始化棋子prefab\n        piecesAtlas: {\n            default: null,\n            type: cc.SpriteAtlas\n        },\n\n        //棋子prefab\n        piecePrefab:{\n            default: null,\n            type: cc.Prefab\n        }\n    },\n\n    //组件加载时，进行变量初始化操作\n    onLoad () {\n\n        this.node.on(cc.Node.EventType.TOUCH_START, function(e){\n\n            var pos = this.node.convertToNodeSpaceAR(e.getLocation());\n           \n            var row = Math.floor( (pos.y + Constant.left_bottom_pos.len_y + Constant.cell_size*0.5) / Constant.cell_size);\n            var col = Math.floor( (pos.x + Constant.left_bottom_pos.len_x + Constant.cell_size*0.5) / Constant.cell_size);\n        \n            //\n            if(row < 0 || row > 9 || col < 0 || col > 8){\n                return;\n            }else{\n                // this.put_piece_at(row, col);\n            }\n\n        }.bind(this), this);\n\n        //初始化32颗棋子\n        this.init32Stones();\n\n\n    },\n\n    init32Stones: function(){\n\n        //棋子初始化信息\n        var game_board_init_info = Constant.game_board_init_info;\n\n        for(var k in game_board_init_info){\n            var stone_info = game_board_init_info[k];\n\n            var row = stone_info.row;\n            var col = stone_info.col;\n            var turn_type = stone_info.turn_type;\n            var stone_type = stone_info.stone_type;\n            var piecePrefab = this.createPieceByName(Constant.stone_res_config[turn_type][stone_type]);\n\n            //创建一颗棋子\n            var stone = new Stone(turn_type, stone_type, false, row, col, piecePrefab); \n            \n            var x =  col * Constant.cell_size - Constant.left_bottom_pos.len_x\n            var y =  row * Constant.cell_size - Constant.left_bottom_pos.len_y;\n            stone.m_piecePrefab.setPosition(x, y);\n            this.node.addChild(stone.m_piecePrefab);\n            //\n\n        }  \n    },\n\n    //在row col处下一颗棋子\n    put_piece_at: function(row, col ){\n   \n        var x =  col * Constant.cell_size - Constant.left_bottom_pos.len_x\n        var y =  row * Constant.cell_size - Constant.left_bottom_pos.len_y;\n\n        //\n        // var piece = this.createPieceByName(\"black_shi\");\n        var piece = this.createPieceByName(Constant.stone_res_config[Constant.turn_type.red][Constant.stone_type.che]);\n        piece.setPosition(x, y);\n        this.node.addChild(piece);\n    },\n\n    //根据棋子名称创建一颗棋子\n    createPieceByName: function(pieceName){\n        var piece = cc.instantiate(this.piecePrefab);\n        piece.getComponent(cc.Sprite).spriteFrame = this.piecesAtlas.getSpriteFrame(pieceName);\n        return piece;\n    }\n});\n"]}